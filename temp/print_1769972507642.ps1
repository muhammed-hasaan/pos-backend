
$printerName = 'BlackCopper 80mm Series(2)'
$hexString = '1b401b61011d211154455354205052494e540a1d21001b61003d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a53686f703a204d5920504f532053484f500a446174653a20322f322f323032362c2031323a30313a343720414d0a5072696e7465723a20426c61636b436f707065722038306d6d205365726965732832290a3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a1b45014974656d20202020202020202020202051747920202050726963650a1b45002d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a54657374204974656d203120202020203220202020203130302e30300a54657374204974656d203220202020203120202020203135302e30300a2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a1b4501544f54414c3a2020202020202020202020202020203235302e30300a1b45003d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a1b61015448414e4b20594f55210a564953495420414741494e0a1b61003d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a0a0a0a1d564110'

# Convert hex to bytes
$bytes = [byte[]]::new(467)
for ($i = 0; $i -lt $hexString.Length; $i += 2) {
    $bytes[$i/2] = [Convert]::ToByte($hexString.Substring($i, 2), 16)
}

# Create temporary file
$tempFile = [System.IO.Path]::GetTempFileName()
[System.IO.File]::WriteAllBytes($tempFile, $bytes)

# Send to printer using RAW format
copy /B "$tempFile" "\\localhost\$printerName"

# Clean up
Remove-Item $tempFile -Force
Write-Output "SUCCESS"
